{"remainingRequest":"/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/node_modules/babel-loader/lib/index.js!/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/node_modules/eslint-loader/index.js??ref--13-0!/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/src/store/modules/user.js","dependencies":[{"path":"/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/src/store/modules/user.js","mtime":1719406800109},{"path":"/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/babel.config.js","mtime":1717069957203},{"path":"/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/node_modules/cache-loader/dist/cjs.js","mtime":1717069957692},{"path":"/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/node_modules/babel-loader/lib/index.js","mtime":1717069957536},{"path":"/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/node_modules/eslint-loader/index.js","mtime":1717069958256}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgc2lnbmluIGFzIF9zaWduaW4gfSBmcm9tICJAL2FwaS91c2VyIjsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiwgc2V0VXNlcm5hbWUsIHNldFJvbGUsIHNldFVzZXJJZCB9IGZyb20gIkAvdXRpbHMvYXV0aCI7CgovLyBpbXBvcnQgeyByZXNldFJvdXRlciB9IGZyb20gIkAvcm91dGVyIjsKCnZhciBnZXREZWZhdWx0U3RhdGUgPSBmdW5jdGlvbiBnZXREZWZhdWx0U3RhdGUoKSB7CiAgcmV0dXJuIHsKICAgIHRva2VuOiBnZXRUb2tlbigpLAogICAgbmFtZTogIiIsCiAgICByb2xlczogIiIKICB9Owp9Owp2YXIgc3RhdGUgPSBnZXREZWZhdWx0U3RhdGUoKTsKdmFyIG11dGF0aW9ucyA9IHsKICBSRVNFVF9TVEFURTogZnVuY3Rpb24gUkVTRVRfU1RBVEUoc3RhdGUpIHsKICAgIE9iamVjdC5hc3NpZ24oc3RhdGUsIGdldERlZmF1bHRTdGF0ZSgpKTsKICB9LAogIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICB9LAogIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgfSwKICBTRVRfUk9MRVM6IGZ1bmN0aW9uIFNFVF9ST0xFUyhzdGF0ZSwgcm9sZXMpIHsKICAgIHN0YXRlLnJvbGVzID0gcm9sZXM7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICAvLyB1c2VyIGxvZ2luCiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKF9yZWYsIHVzZXJJbmZvKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICB2YXIgdXNlcm5hbWUgPSB1c2VySW5mby51c2VybmFtZSwKICAgICAgcGFzc3dvcmQgPSB1c2VySW5mby5wYXNzd29yZDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9sb2dpbih7CiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLnRyaW0oKSwKICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGEsCiAgICAgICAgICB0b2tlbiA9IHJlc3BvbnNlLnRva2VuOwogICAgICAgIGNvbW1pdCgiU0VUX1RPS0VOIiwgdG9rZW4pOwogICAgICAgIHNldFRva2VuKHRva2VuKTsKICAgICAgICAvLyByZXNvbHZlKCk7CiAgICAgICAgLy8gZ2V0IHVzZXIgaW5mbwogICAgICAgIHZhciByb2xlID0gZGF0YS5yb2xlLAogICAgICAgICAgdXNlcm5hbWUgPSBkYXRhLnVzZXJuYW1lLAogICAgICAgICAgaWQgPSBkYXRhLmlkOwoKICAgICAgICAvLyAvLyByb2xlcyBtdXN0IGJlIGFub24tZW1wdHkgYXJyYXkKICAgICAgICAvLyBpZiAoIXJvbGVzIHx8IHJvbGVzLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgLy8gICByZWplY3QoImdldEluZm86IHJvbGVzIG11c3QgYmUgYSBub24tbnVsbCBhcnJheSEiKTsKICAgICAgICAvLyB9CgogICAgICAgIGNvbW1pdCgiU0VUX1JPTEVTIiwgcm9sZSk7CiAgICAgICAgY29tbWl0KCJTRVRfTkFNRSIsIHVzZXJuYW1lKTsKICAgICAgICBzZXRSb2xlKHJvbGUpOwogICAgICAgIHNldFVzZXJuYW1lKHVzZXJuYW1lKTsKICAgICAgICBzZXRVc2VySWQoaWQpOwogICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyB1c2VyICBzaWduaW5nCiAgc2lnbmluOiBmdW5jdGlvbiBzaWduaW4oX3JlZjIsIHVzZXJJbmZvKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0OwogICAgLy8gY29uc29sZS5sb2codXNlckluZm8sICJ1c2VySW5mbyIpOwogICAgdmFyIHVzZXJuYW1lID0gdXNlckluZm8udXNlcm5hbWUsCiAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQsCiAgICAgIHJvbGVfdG9rZW4gPSB1c2VySW5mby5yb2xlX3Rva2VuOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX3NpZ25pbih7CiAgICAgICAgdG9rZW46IHJvbGVfdG9rZW4KICAgICAgfSwgewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIC8vIGNvbW1pdCgiU0VUX1RPS0VOIiwgZGF0YS50b2tlbik7CiAgICAgICAgLy8gc2V0VG9rZW4oZGF0YS50b2tlbik7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gZ2V0IHVzZXIgaW5mbwogIC8vIGdldEluZm8oeyBjb21taXQsIHN0YXRlIH0pIHsKICAvLyAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgLy8gICAgIGdldEluZm8oc3RhdGUudG9rZW4pCiAgLy8gICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgLy8gICAgICAgICBjb25zdCB7IGRhdGEgfSA9IHJlc3BvbnNlOwogIC8vICAgICAgICAgaWYgKCFkYXRhKSB7CiAgLy8gICAgICAgICAgIHJlamVjdCgiVmVyaWZpY2F0aW9uIGZhaWxlZCwgcGxlYXNlIExvZ2luIGFnYWluLiIpOwogIC8vICAgICAgICAgfQogIC8vICAgICAgICAgY29uc3QgeyByb2xlcywgbmFtZSB9ID0gZGF0YTsKICAvLyAgICAgICAgIC8vIHJvbGVzIG11c3QgYmUgYSBub24tZW1wdHkgYXJyYXkKICAvLyAgICAgICAgIGlmICghcm9sZXMgfHwgcm9sZXMubGVuZ3RoIDw9IDApIHsKICAvLyAgICAgICAgICAgcmVqZWN0KCJnZXRJbmZvOiByb2xlcyBtdXN0IGJlIGEgbm9uLW51bGwgYXJyYXkhIik7CiAgLy8gICAgICAgICB9CiAgLy8gICAgICAgICBjb21taXQoIlNFVF9ST0xFUyIsIHJvbGVzKTsKICAvLyAgICAgICAgIGNvbW1pdCgiU0VUX05BTUUiLCBuYW1lKTsKICAvLyAgICAgICAgIC8vIGNvbW1pdCgiU0VUX0FWQVRBUiIsIGF2YXRhcik7CiAgLy8gICAgICAgICByZXNvbHZlKGRhdGEpOwogIC8vICAgICAgIH0pCiAgLy8gICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogIC8vICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAvLyAgICAgICB9KTsKICAvLyAgIH0pOwogIC8vIH0sCiAgLy8gLy8gdXNlciBsb2dvdXQKICAvLyBsb2dvdXQoeyBjb21taXQsIHN0YXRlIH0pIHsKICAvLyAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgLy8gICAgIGxvZ291dChzdGF0ZS50b2tlbikKICAvLyAgICAgICAudGhlbigoKSA9PiB7CiAgLy8gICAgICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CiAgLy8gICAgICAgICByZXNldFJvdXRlcigpOwogIC8vICAgICAgICAgY29tbWl0KCJSRVNFVF9TVEFURSIpOwogIC8vICAgICAgICAgcmVzb2x2ZSgpOwogIC8vICAgICAgIH0pCiAgLy8gICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogIC8vICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAvLyAgICAgICB9KTsKICAvLyAgIH0pOwogIC8vIH0sCiAgLy8gcmVtb3ZlIHRva2VuCiAgcmVzZXRUb2tlbjogZnVuY3Rpb24gcmVzZXRUb2tlbihfcmVmMykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CiAgICAgIGNvbW1pdCgiUkVTRVRfU1RBVEUiKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"names":["login","signin","getToken","setToken","removeToken","setUsername","setRole","setUserId","getDefaultState","token","name","roles","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_ROLES","actions","_ref","userInfo","commit","username","password","Promise","resolve","reject","trim","then","response","data","role","id","catch","error","_ref2","role_token","resetToken","_ref3","namespaced"],"sources":["/Users/chenxing/WebProjects/lib_web/frontend/vue-web-frontiers/src/store/modules/user.js"],"sourcesContent":["import { login, signin } from \"@/api/user\";\nimport {\n  getToken,\n  setToken,\n  removeToken,\n  setUsername,\n  setRole,\n  setUserId,\n} from \"@/utils/auth\";\n\n// import { resetRouter } from \"@/router\";\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: \"\",\n    roles: \"\",\n  };\n};\n\nconst state = getDefaultState();\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState());\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token;\n  },\n  SET_NAME: (state, name) => {\n    state.name = name;\n  },\n  SET_ROLES: (state, roles) => {\n    state.roles = roles;\n  },\n};\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    const { username, password } = userInfo;\n    return new Promise((resolve, reject) => {\n      login({ username: username.trim(), password: password })\n        .then((response) => {\n          const { data, token } = response;\n          commit(\"SET_TOKEN\", token);\n          setToken(token);\n          // resolve();\n          // get user info\n          const { role, username, id } = data;\n\n          // // roles must be anon-empty array\n          // if (!roles || roles.length <= 0) {\n          //   reject(\"getInfo: roles must be a non-null array!\");\n          // }\n\n          commit(\"SET_ROLES\", role);\n          commit(\"SET_NAME\", username);\n          setRole(role);\n          setUsername(username);\n          setUserId(id);\n          resolve(data);\n        })\n        .catch((error) => {\n          reject(error);\n        });\n    });\n  },\n\n  // user  signing\n  signin({ commit }, userInfo) {\n    // console.log(userInfo, \"userInfo\");\n    const { username, password, role_token } = userInfo;\n    return new Promise((resolve, reject) => {\n      signin(\n        { token: role_token },\n        {\n          username: username.trim(),\n          password: password,\n        }\n      )\n        .then((response) => {\n          const { data } = response;\n          // commit(\"SET_TOKEN\", data.token);\n          // setToken(data.token);\n          resolve();\n        })\n        .catch((error) => {\n          reject(error);\n        });\n    });\n  },\n\n  // get user info\n  // getInfo({ commit, state }) {\n  //   return new Promise((resolve, reject) => {\n  //     getInfo(state.token)\n  //       .then((response) => {\n  //         const { data } = response;\n\n  //         if (!data) {\n  //           reject(\"Verification failed, please Login again.\");\n  //         }\n\n  //         const { roles, name } = data;\n\n  //         // roles must be a non-empty array\n  //         if (!roles || roles.length <= 0) {\n  //           reject(\"getInfo: roles must be a non-null array!\");\n  //         }\n\n  //         commit(\"SET_ROLES\", roles);\n  //         commit(\"SET_NAME\", name);\n  //         // commit(\"SET_AVATAR\", avatar);\n  //         resolve(data);\n  //       })\n  //       .catch((error) => {\n  //         reject(error);\n  //       });\n  //   });\n  // },\n\n  // // user logout\n  // logout({ commit, state }) {\n  //   return new Promise((resolve, reject) => {\n  //     logout(state.token)\n  //       .then(() => {\n  //         removeToken(); // must remove  token  first\n  //         resetRouter();\n  //         commit(\"RESET_STATE\");\n  //         resolve();\n  //       })\n  //       .catch((error) => {\n  //         reject(error);\n  //       });\n  //   });\n  // },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise((resolve) => {\n      removeToken(); // must remove  token  first\n      commit(\"RESET_STATE\");\n      resolve();\n    });\n  },\n};\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n};\n"],"mappings":"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","ignoreList":[]}]}